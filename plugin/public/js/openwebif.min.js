$.fx.speeds._default=1e3;var current_serviceref,current_begin,current_end,theme="original",loadspinner="<div id='spinner'><div class='fa fa-spinner fa-spin'></div></div>",mutestatus=0,lastcontenturl=null,screenshotMode="all",MessageAnswerCounter=0,grabTimer=0,at2add=null,_locations=[],_tags=[],current_ref=null,current_name=null,selectedfolder="",pipstatus=!1;function initJsTranslation(e){tstr_add_timer=e.add_timer,tstr_cancel=e.cancel,tstr_close=e.close,tstr_del_timer=e.delete_timer_question,tstr_del_autotimer=e.at_delete_autotimer_question,tstr_del_recording=e.delete_recording_question,tstr_ren_recording=e.rename_recording_question,tstr_edit_recording=e.edit_recording,tstr_done=e.done,tstr_edit_timer=e.edit_timer,tstr_hour=e.hour,tstr_save=e.save,tstr_minute=e.minute,tstr_nothing_play=e.nothing_play,tstr_now=e.now,tstr_on=e.on,tstr_reboot_box=e.reboot_box,tstr_rec_status=e.rec_status,tstr_restart_gui=e.restart_gui,tstr_standby=e.standby,tstr_start_after_end=e.start_after_end,tstr_time=e.time,tstr_zap_to=e.zap_to,tstr_january=e.month_01,tstr_february=e.month_02,tstr_march=e.month_03,tstr_april=e.month_04,tstr_may=e.month_05,tstr_june=e.month_06,tstr_july=e.month_07,tstr_august=e.month_08,tstr_september=e.month_09,tstr_october=e.month_10,tstr_november=e.month_11,tstr_december=e.month_12,tstr_monday=e.monday,tstr_tuesday=e.tuesday,tstr_wednesday=e.wednesday,tstr_thursday=e.thursday,tstr_friday=e.friday,tstr_saturday=e.saturday,tstr_sunday=e.sunday,tstr_mo=e.mo,tstr_tu=e.tu,tstr_we=e.we,tstr_th=e.th,tstr_fr=e.fr,tstr_sa=e.sa,tstr_su=e.su,tstr_loading=e.loading,tstr_stream=e.stream,tstr_transcoded=e.transcoded,tstr_send_message=e.send_message,tstr_sent_wait=e.sent_wait,tstr_epgsearch=e.epgsearch,tstr_bqe_del_channel_question=e.bqe_del_channel_question,tstr_bqe_del_bouquet_question=e.bqe_del_bouquet_question,tstr_bqe_name_bouquet=e.bqe_name_bouquet,tstr_bqe_name_marker=e.bqe_name_marker,tstr_bqe_rename_bouquet=e.bqe_rename_bouquet,tstr_bqe_rename_marker=e.bqe_rename_marker,tstr_bqe_filename=e.bqe_filename,tstr_bqe_restore_question=e.bqe_restore_question,tstr_timer=e.timer,tstr_timerlist=e.timer_list,tstr_timerpreview=e.timer_preview,tstr_timernewname=e.timer_newname,tstr_open_in_new_window=e.open_in_new_window,tstr_error_load_page=e.tstr_error_load_page,tstr_timer_added=e.tstr_timer_added,tstr_event_not_found=e.tstr_event_not_found,tstr_channel=e.channel,tstr_end=e.begin,tstr_begin=e.end,tstr_rename_recording=e.rename_recording}function wait_for_openwebif(){let e=window.setInterval(function(){webapi_execute("/api/statusinfo",function(){window.clearInterval(e),$("#modaldialog").dialog("close"),location.reload()})},2e3)}function handle_power_state_dialog(e){let t=0;var n=loadspinner.replace("'spinner'","'spinner1'");$("#modaldialog").dialog("close"),2===e?(load_reboot_dialog(n,tstr_reboot_box),wait_for_openwebif(),t=1e3):3===e&&(load_reboot_dialog(n,tstr_restart_gui),wait_for_openwebif(),t=1e3),setTimeout(function(){webapi_execute("api/powerstate?newstate="+e)},t)}function load_reboot_dialog(e,t){$("#modaldialog").html(e).dialog({modal:!0,title:t,autoOpen:!0,width:"auto",height:"auto",open:function(e,t){$("#modaldialog").css("overflow","hidden")},close:function(e,t){$(this).dialog("destroy"),$("#modaldialog").html("")}})}function load_dm_spinner(e,t,n,i,a){let o="auto",r="auto";void 0!==n&&(o=n),void 0!==i&&(r=i),$("#modaldialog").html(loadspinner).dialog({modal:!0,title:t,autoOpen:!0,width:o,height:r,buttons:a,create:function(e,t){$(e.target).parent().css("position","fixed")},close:function(e,t){$(this).dialog("destroy"),$("#modaldialog").html("")},open:function(){$.ajax({url:e,success:function(e){$("#modaldialog").html(e)},error:function(){$("#modaldialog").html(tstr_error_load_page)}}),$(this).siblings(".ui-dialog-buttonpane").find("button:eq(0)").focus()}})}function load_dm(e,t,n,i){let a={},o=(a[tstr_close]=function(){$(this).dialog("close")},"auto"),r="auto";void 0!==n&&(o=n),void 0!==i&&(r=i),$.ajax({url:e,success:function(e){$("#modaldialog").html(e).dialog({modal:!0,title:t,autoOpen:!0,width:o,height:r,buttons:a,close:function(e,t){$(this).dialog("destroy"),$("#modaldialog").html("")},open:function(){$(this).siblings(".ui-dialog-buttonpane").find("button:eq(0)").focus()}})},error:function(){alert(tstr_error_load_page)}})}function load_message_dm(e,t){let n={};n[tstr_send_message]=function(){sendMessage()},n[tstr_cancel]=function(){$(this).dialog("close")},$.ajax({url:e,success:function(e){$("#modaldialog").html(e).dialog({modal:!0,title:t,autoOpen:!0,width:"auto",buttons:n,close:function(e,t){$(this).dialog("destroy"),$("#modaldialog").html("")}})}})}function dialog_notyet(){return $("#dialog").dialog("open"),!1}function load_tvcontent(e){return $("#tvcontent").load(e),!1}function load_tvcontent_spin(e){return $("#tvcontent").html(loadspinner).load(e),!1}function load_maincontent(e){return(lastcontenturl!=e||-1<e.indexOf("screenshot")||-1<e.indexOf("timer")||-1<e.indexOf("boxinfo"))&&($("#content_container").load(e),lastcontenturl=e),!1}function load_maincontent_spin(e){var t;return lastcontenturl!=e&&(t='<div id="content_main" style="min-height: 500px;">'+loadspinner+"</div>",$("#content_container").html(t).load(e),lastcontenturl=e),!1}function webapi_execute(e,t){$.ajax({url:e,cache:!1,async:!1}).done(function(){void 0!==t&&t()});return!1}function toggle_chan_des(e,t,n){t="ajax/eventdescription?sref="+escape(t)+"&idev="+e,e="#"+n;$(e).load(t),$(e).slideToggle(200)}function open_epg_dialog(e,t){var n="ajax/epgdialog?sref="+escape(e),i=$(window).width()-100,a=$(window).height()-100,o={};o[tstr_close]=function(){$(this).dialog("close")},o[tstr_open_in_new_window]=function(){$(this).dialog("close"),open_epg_pop(e)},load_dm_spinner(n,t,i,a,o)}function open_epg_search_dialog(){let e=$("#epgSearch").val(),t=GetLSValue("epgsearchtype",!1)?"&full=1":"";var n=GetLSValue("epgsearchbouquetsonly",!1)?"&bouquetsonly=1":"",n="ajax/epgdialog?sstr="+encodeURIComponent(e)+t+n,i=($("#epgSearch").val(""),$(window).width()-100),a=$(window).height()-100,o={};o[tstr_close]=function(){$(this).dialog("close")},o[tstr_open_in_new_window]=function(){$(this).dialog("close"),open_epg_search_pop(e,t)},load_dm_spinner(n,tstr_epgsearch,i,a,o)}function _epg_pop(e){$.popupWindow(e,{height:$(window).height(),width:$(window).width(),toolbar:!1,scrollbars:!0})}function open_epg_search_pop(e,t){_epg_pop("ajax/epgpop?sstr="+encodeURIComponent(e)+t)}function open_epg_pop(e){_epg_pop("ajax/epgpop?sref="+escape(e))}function TimerConflict(e,t,n,i){let a="<div class='tbltc'><div><div>Name</div><div>"+tstr_channel+"</div><div>"+tstr_end+"</div><div>"+tstr_begin+"</div></div>";e.forEach(function(e){a+="<div><div>"+e.name+"</div><div>"+e.servicename+"</div><div>"+e.realbegin+"</div><div>"+e.realend+"</div></div>"}),a+="</div>";e={};e[tstr_close]=function(){$(this).dialog("close")},$("<div></div>").dialog({modal:!0,height:500,width:600,autoOpen:!0,title:"Timer Conflicts",open:function(){$(this).html(a)},buttons:e})}function webapi_execute_result(e,t){$.ajax({async:!1,url:e,cache:!1,dataType:"json",success:function(e){void 0!==t&&(e?t(e.result,e.message,e.conflicts):t(!1,"error"))}})}function cbAddTimerEvent(e){e.state&&($(".event[data-id="+e.eventId+'][data-ref="'+e.sRef+'"] .timer').remove(),$(".event[data-id="+e.eventId+'][data-ref="'+e.sRef+'"] div:first').append('<div class="timer">'+tstr_timer+"</div>"))}function addTimerEvent(i,a,o,r){let e="/api/timeraddbyeventid?sRef="+i+"&eventid="+a;o&&(e+="&eit=0&disabled=0&justplay=1&afterevent=3"),webapi_execute_result(e,function(e,t,n){!e&&n?TimerConflict(n,i,a,o):void 0!==r?r({sRef:i,eventId:a,justplay:o,state:e,txt:t}):alert(e?tstr_timer_added:t)})}function addEditTimerEvent(e,t){$.ajax({url:"/api/event?sRef="+e+"&idev="+t,dataType:"json",success:function(e){void 0!==e&&void 0!==e.event?addTimer(e.event):alert(tstr_event_not_found)},error:function(e){}})}function htmlEscape(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function addAutoTimerEvent(e,t,n,i,a){at2add={name:htmlEscape(n),from:i,to:a,sref:e,sname:t},lastcontenturl="",$("#compressmepg").is(":visible")&&CompressMEPG(),$("#modaldialog").hasClass("ui-dialog-content")&&($("#modaldialog").dialog("destroy"),$("#modaldialog").html("")),$("#eventdescription").hasClass("ui-dialog-content")&&($("#eventdescription").dialog("destroy"),$("#eventdescription").html("")),load_maincontent("ajax/at")}function delTimerEvent(i,a){$.ajax({url:"/api/event?sRef="+i+"&idev="+a,dataType:"json",success:function(e){var t,n;void 0!==e&&void 0!==e.event?(t=e.event.begin-60*e.event.recording_margin_before,n=e.event.begin+e.event.duration+60*e.event.recording_margin_after,e=decodeURIComponent(e.event.title),!0===confirm(tstr_del_timer+": "+e)&&webapi_execute("/api/timerdelete?sRef="+i+"&begin="+t+"&end="+n+"&eit="+a,function(){$(".event[data-id="+a+"] .timer").remove()})):alert(tstr_event_not_found)},error:function(e){}})}function toggleTimerStatus(t,n,i){$.ajax({url:"/api/timertogglestatus?",dataType:"json",data:{sRef:t,begin:n,end:i},success:function(e){$("#img-"+n+"-"+i+" > i").each(function(){$(this).data("ref")==t&&($(this).removeClass("fa-square-o"),$(this).removeClass("fa-check-square-o"),$(this).addClass(e.disabled?"fa-square-o":"fa-check-square-o"))})},error:function(e){}})}function deleteTimer(e,t,n,i){i=decodeURIComponent(i);!0===confirm(tstr_del_timer+": "+i)&&webapi_execute("/api/timerdelete?sRef="+e+"&begin="+t+"&end="+n,function(){$("#"+t+"-"+n).remove()})}function cleanupTimer(){webapi_execute("/api/timercleanup",function(){load_maincontent("/ajax/timers")})}function webapi_execute_movie(e,t){$.ajax({async:!1,url:e,cache:!1,dataType:"json",success:function(e){e&&(e.result||alert(e.message),void 0!==t&&t(e.result))}})}function renameMovie(e,t){var n=prompt(tstr_ren_recording,t);n&&n!=t&&webapi_execute_movie("/api/movierename?sRef="+e+"&newname="+n)}function deleteMovie(e,t,n){!0===confirm(tstr_del_recording+": "+n)&&webapi_execute_movie("/api/moviedelete?sRef="+e,function(e){e&&$("#"+t).remove()})}function playRecording(e){e=e.replace(/-/g,"%2D").replace(/_/g,"%5F").replace(/\//g,"%2F"),console.debug(e),e="/api/zap?sRef="+e;webapi_execute(e,function(){$("#osd").html(" "),$("#osd_bottom").html(" ")})}function zapChannel(e,t){webapi_execute("/api/zap?sRef="+escape(e),function(){$("#osd").html(tstr_zap_to+": "+t),$("#osd_bottom").html(" ")})}function toggleStandby(e){webapi_execute("api/powerstate?newstate=0"+(e?"&shift=1":"")),setTimeout(getStatusInfo,1500)}function setOSD(n){var i=n.currservice_serviceref,a=n.currservice_station;if(current_ref=i,current_name=a){var o=a.replace(/'/g,"\\'");let e="<div id='osdicon'>";var r=tstr_stream+": "+a+"'><i class='fa fa-desktop'></i></a>",s=tstr_stream+" ("+tstr_transcoded+"): "+a+"'><i class='fa fa-mobile'></i></a>",a="<span class='osdch'>"+a+"</span></a>&nbsp;&nbsp;"+n.currservice_begin+" - "+n.currservice_end+"&nbsp;&nbsp;";let t=n.currservice_fulldescription;t=t.replace(/'/g,"\\'"),-1!==i.indexOf("1:0:1")||-1!==i.indexOf("1:134:1")?(n.transcoding?e=e+"<a href='#' onclick=\"jumper8001('"+i+"', '"+o+"')\"; title='"+r+"<a href='#' onclick=\"jumper8002('"+i+"', '"+o+"')\"; title='"+s:e+="<a target='_blank' href='/web/stream.m3u?ref="+i+"&name="+o+"&fname="+o+"' title='"+r,e+="</div>",$("#osd").html(e+"<a href='#' onclick='load_maincontent(\"ajax/tv\");return false;'>"+a+"<a style='text-decoration:none;' href=\"#\" onclick=\"open_epg_pop('"+i+"')\" title='"+t+"'>"+n.currservice_name+"</a>")):-1!==i.indexOf("1:0:2")||-1!==i.indexOf("1:0:A")||-1!==i.indexOf("1:134:2")?(e=e+"<a target='_blank' href='/web/stream.m3u?ref="+i+"&name="+o+"&fname="+o+"' title='"+r+"</div>",$("#osd").html(e+"<a href='#' onclick='load_maincontent(\"ajax/radio\");return false;'>"+a+"<a style='text-decoration:none;' href=\"#\" onclick=\"open_epg_pop('"+i+"')\" title='"+t+"'>"+n.currservice_name+"</a>")):-1!==i.indexOf("1:0:0")?(o=n.currservice_filename.replaceAll("'","%27").replaceAll('"',"%22"),n.transcoding?e=e+"<a href='#' onclick=\"jumper80('"+o+"')\"; title='"+r+"<a href='#' onclick=\"jumper8003('"+o+"')\"; title='"+s:e+="<a target='_blank' href='/web/ts.m3u?file="+o+"' title='"+r,e+="</div>",$("#osd").html(e+a+n.currservice_name)):$("#osd").html(a+n.currservice_name),$("#osd_bottom").html(n.currservice_description)}else $("#osd").html(tstr_nothing_play),$("#osd_bottom").html("")}function getStatusInfo(){$.ajax({url:"/api/statusinfo",dataType:"json",cache:!1,success:function(e){$("#slider").slider("value",e.volume),$("#amount").val(e.volume),1==e.muted?(mutestatus=1,$("#volimage").attr("src","/images/volume_mute.png")):(mutestatus=0,$("#volimage").attr("src","/images/volume.png")),setOSD(e);tstr_standby;"true"!==e.inStandby&&tstr_on;let t="";"true"==e.isRecording&&(t="<a href='#' onclick='load_maincontent(\"ajax/timers\"); return false;'><div title='"+tstr_rec_status+e.Recording_list+"' class='led-box'><div class='led-red'></div></div></a>"),t+="<a href='#' onclick='toggleStandby();return false'><img src='../images/ico_","true"==e.inStandby?t+="standby.png' title='"+tstr_on+"' alt='"+tstr_standby:t+="on.png' title='"+tstr_standby+"' alt='"+tstr_on,t+="' width='56' height='29' /></a>",$("#osd_status").html(t)},error:function(){$("#osd, #osd_bottom").html("")}})}function grabScreenshot(e){$("#screenshotspinner").show(),$("#screenshotimage").load(function(){$("#screenshotspinner").hide()}),"auto"!=e?screenshotMode=e:e=screenshotMode,timestamp=(new Date).getTime(),SSHelper.ssr_hd?$("#screenshotimage").attr("src","/grab?format=jpg&mode="+e+"&t="+timestamp):$("#screenshotimage").attr("src","/grab?format=jpg&r=720&mode="+e+"&t="+timestamp),"lcd"==e?$("#screenshotimage").css("width","auto"):$("#screenshotimage").css("width","100%")}function getMessageAnswer(){$.ajax({url:"/api/messageanswer",dataType:"json",cache:!1,success:function(e){$("#messageSentResponse").html(e.message)}})}function countdowngetMessage(){--MessageAnswerCounter<3?getMessageAnswer():($("#messageSentResponse").html(tstr_sent_wait+" "+MessageAnswerCounter),setTimeout(countdowngetMessage,1e3))}function sendMessage(){var e=$("#messageText").val();let t=$("#messageType").val(),n=$("#messageTimeout").val();$.ajax({url:"/api/message?text="+e+"&type="+t+"&timeout="+n,dataType:"json",cache:!1,success:function(e){$("#messageSentResponse").html(e.message),0==t&&(MessageAnswerCounter=n,setTimeout(countdowngetMessage,1e3))}})}function toggleMenu(e){var t="#leftmenu_expander_"+e,n="#leftmenu_container_"+e;$(t).hasClass("ui-icon-caret-1-w")?($(t).removeClass("ui-icon-caret-1-w"),$(t).addClass("ui-icon-caret-1-s"),$(n).show("fast"),webapi_execute("/api/expandmenu?name="+e)):($(t).addClass("ui-icon-caret-1-w"),$(t).removeClass("ui-icon-caret-1-s"),$(n).hide("fast"),webapi_execute("/api/collapsemenu?name="+e))}function callScreenShot(){testPipStatus(),GetLSValue("remotegrabscreen",!0)&&("ajax/screenshot"==lastcontenturl?grabScreenshot(screenshotMode):load_maincontent("ajax/screenshot"))}function pressMenuRemote(e,t){webapi_execute("/api/remotecontrol?"+(t?"type=long&":"")+"command="+e),0<grabTimer&&clearTimeout(grabTimer),grabTimer=setTimeout(function(){callScreenShot()},1<e&&e<12?1500:1e3)}function toggleFullRemote(){$("#menucontainer").toggle(),$("#remotecontainer").toggle()}function saveConfig(e,t,n){$.ajax({url:"/api/saveconfig?key="+escape(e)+"&value="+escape(t),cache:!1,async:!0,type:"POST"}).done(function(){"config.usage.setup_level"==e?$("#content_container").load(lastcontenturl):load_scontent("ajax/config?section="+n)})}function numberTextboxKeydownFilter(e){46!=e.keyCode&&8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<48||57<e.keyCode)&&(e.keyCode<96||105<e.keyCode)&&e.preventDefault()}$(function(){SetSpinner();try{$("#dialog").dialog({autoOpen:!1,show:"fade",hide:"explode",buttons:{Ok:function(){$(this).dialog("close")}}}),$("#volimage").click(function(){0===mutestatus?(mutestatus=1,$("#volimage").attr("src","/images/volume_mute.png")):(mutestatus=0,$("#volimage").attr("src","/images/volume.png")),$.ajax("web/vol?set=mute")}),getStatusInfo(),setInterval(function(){getStatusInfo()},15e3),$("#slider").slider({range:"min",min:0,max:100,value:40,slide:function(e,t){$("#amount").val(t.value)},stop:function(e,t){0==t.value?$("#volimage").attr("src","/images/volume_mute.png"):$("#volimage").attr("src","/images/volume.png");$.ajax("web/vol?set=set"+t.value);return!1}}),$("#amount").val($("#slider").slider("value")),$(".epgsearch button:first").button({icons:{primary:"ui-icon-search"}}),loadLocations(),loadTags()}catch(e){}}),function(o){let r={height:500,width:500,toolbar:!1,scrollbars:!1,status:!1,resizable:!1,left:0,top:0,center:!0,createNew:!0,location:!1,menubar:!1,onUnload:null};o.popupWindow=function(e,t){let n=o.extend({},r,t);n.center&&(n.top=(screen.height-n.height)/2-50,n.left=(screen.width-n.width)/2);var t=[],i=(t.push("location="+(n.location?"yes":"no")),t.push("menubar="+(n.menubar?"yes":"no")),t.push("toolbar="+(n.toolbar?"yes":"no")),t.push("scrollbars="+(n.scrollbars?"yes":"no")),t.push("status="+(n.status?"yes":"no")),t.push("resizable="+(n.resizable?"yes":"no")),t.push("height="+n.height),t.push("width="+n.width),t.push("left="+n.left),t.push("top="+n.top),(new Date).getTime()),i=n.createNew?"popup_window_"+i:"popup_window";let a=window.open(e,i,t.join(","));if(n.onUnload&&"function"==typeof n.onUnload){let e=setInterval(function(){a&&!a.closed||(clearInterval(e),n.onUnload())},250)}return a&&a.focus&&a.focus(),a}}(jQuery),$(function(){$(".remotegrabscreen").click(function(e){$(".remotegrabscreen").prop("checked",e.currentTarget.checked),SetLSValue("remotegrabscreen",e.currentTarget.checked)}),$(".remotegrabscreen").prop("checked",GetLSValue("remotegrabscreen",!0)),$("input[name=epgsearchtype]").click(function(e){$("input[name=epgsearchtype]").prop("checked",e.currentTarget.checked),SetLSValue("epgsearchtype",e.currentTarget.checked)}),void 0!==$("input[name=epgsearchtype]")?$("input[name=epgsearchtype]").prop("checked",GetLSValue("epgsearchtype",!1)):SetLSValue("epgsearchtype",!1),$("input[name=epgsearchbouquetsonly]").click(function(e){$("input[name=epgsearchbouquetsonly]").prop("checked",e.currentTarget.checked),SetLSValue("epgsearchbouquetsonly",e.currentTarget.checked)}),void 0!==$("input[name=epgsearchbouquetsonly]")?$("input[name=epgsearchbouquetsonly]").prop("checked",GetLSValue("epgsearchbouquetsonly",!1)):SetLSValue("epgsearchbouquetsonly",!1),$("input[name=themeMode]").click(function(e){$("input[name=themeMode]").prop("checked",e.currentTarget.checked),SetLSValue("themeMode",e.currentTarget.checked)}),void 0!==$("input[name=themeMode]")?$("input[name=themeMode]").prop("checked",GetLSValue("themeMode",!1)):SetLSValue("themeMode",!1)});var timeredit_initialized=!1,timeredit_begindestroy=!1;function initTimerBQ(e,n){$("#bouquet_select").find("optgroup").remove().end(),$("#bouquet_select").find("option").remove().end(),GetAllServices(function(e,t){$("#bouquet_select").append(e),current_ref&&$("#bouquet_select").val(current_ref),$("#bouquet_select").trigger("chosen:updated"),n()},e)}function initTimerEdit(e,n){initTimerBQ(e,function(){for(var e in $("#dirname").find("option").remove().end(),$("#dirname").append($("<option></option>").attr("value","None").text("Default")),_locations){e=_locations[e];$("#dirname").append($("<option></option>").attr("value",e).text(e))}for(var t in $("#tagsnew").html(""),_tags){t=_tags[t];$("#tagsnew").append("<input type='checkbox' name='"+t+"' value='"+t+"' id='tag_"+t+"'/><label for='tag_"+t+"'>"+t+"</label>")}$("#tagsnew > input").checkboxradio({icon:!1}),timeredit_initialized=!0,n()})}function loadLocations(){_locations=[],$.ajax({url:"/api/getlocations",dataType:"json",success:function(e){e.result&&(_locations=e.locations)}})}function loadTags(){_tags=[],$.ajax({url:"/api/gettags",dataType:"json",success:function(e){e.result&&(_tags=e.tags)}})}function checkVPS(){$("#vpsplugin_enabled").is(":checked")?($("#vpsplugin_safemode").show(),$("#has_vpsplugin2").show()):($("#vpsplugin_safemode").hide(),$("#has_vpsplugin2").hide())}function initTimerEditBegin(){$("#timerbegin").datetimepicker({timeText:tstr_time,hourText:tstr_hour,minuteText:tstr_minute,currentText:tstr_now,closeText:tstr_done,monthNames:[tstr_january,tstr_february,tstr_march,tstr_april,tstr_may,tstr_june,tstr_july,tstr_august,tstr_september,tstr_october,tstr_november,tstr_december],dayNames:[tstr_sunday,tstr_monday,tstr_tuesday,tstr_wednesday,tstr_thursday,tstr_friday,tstr_saturday,tstr_sunday],dayNamesMin:[tstr_su,tstr_mo,tstr_tu,tstr_we,tstr_th,tstr_fr,tstr_sa,tstr_su],dateFormat:"dd.mm.yy",timeFormat:"HH:mm",onClose:function(e,t){var n;""!=$("#timerend").val()&&$(this).datetimepicker("getDate")>$("#timerend").datetimepicker("getDate")?(n=new Date($(this).datetimepicker("getDate")),n=new Date(n.getTime()+36e5),$("#timerend").datetimepicker("setDate",n)):$("#errorbox").hide()}})}function isRadio(e){let t=!1;return t=void 0!==e&&6<e.length?"1:0:2:"==e.substring(0,6)||"1:0:A:"==e.substring(0,6):t}function editTimer(t,o,r){t=decodeURI(t),current_begin=o,current_end=r;function e(){timeredit_begindestroy&&(initTimerEditBegin(),timeredit_begindestroy=!1),$.ajax({url:"/api/timerlist",dataType:"json",success:function(e){if(e.result)for(var n in e.timers)if((timer=e.timers[n]).serviceref==t&&Math.round(timer.begin)==Math.round(o)&&Math.round(timer.end)==Math.round(r)){$("#timername").val(timer.name),$("#description").val(timer.description),$("#bouquet_select").val(timer.serviceref),$("#bouquet_select").trigger("chosen:updated"),timer.serviceref!==$("#bouquet_select").val()&&($("#bouquet_select").append($("<option></option>").attr("value",timer.serviceref).text(timer.servicename)),$("#bouquet_select").val(timer.serviceref)),$("#dirname").val(timer.dirname),timer.dirname!==$("#dirname").val()&&(n="<option value='"+timer.dirname+"'>"+timer.dirname+"</option>",$("#dirname").append(n),$("#dirname").val(timer.dirname)),$("#enabled").prop("checked",0==timer.disabled),$("#justplay").prop("checked",timer.justplay),$("#afterevent").val(timer.afterevent),$("#recordingtype").val(timer.recordingtype),$("#errorbox").hide();let t=timer.repeated;for(let e=0;e<7;e++)$("#day"+e).prop("checked",1==(1&t)).checkboxradio("refresh"),t>>=1;$("#tagsnew > input").prop("checked",!1).checkboxradio("refresh");var i=timer.tags.split(" ");for(let e=0;e<i.length;e++){var a=i[e].replace(/\(/g,"_").replace(/\)/g,"_").replace(/\'/g,"_");0<a.length&&($("#tag_"+a).length?$("#tag_"+a).prop("checked",!0).checkboxradio("refresh"):$("#tagsnew").append("<input type='checkbox' checked='checked' name='"+a+"' value='"+a+"' id='tag_"+a+"'/><label for='tag_"+a+"'>"+a+"</label>"))}$("#tagsnew > input").checkboxradio({icon:!1}),$("#timerbegin").datetimepicker("setDate",new Date(1e3*Math.round(timer.begin))),$("#timerend").datetimepicker("setDate",new Date(1e3*Math.round(timer.end)));n=2===timer.state;n?($("#timerbegin").datetimepicker("destroy"),timeredit_begindestroy=!0,$("#timerbegin").addClass("ui-state-disabled"),$("#timername").addClass("ui-state-disabled"),$("#dirname option").not(":selected").attr("disabled","disabled"),$("#bouquet_select option").not(":selected").attr("disabled","disabled")):($("#timername").removeClass("ui-state-disabled"),$("#timerbegin").removeClass("ui-state-disabled"),$("#dirname option").removeAttr("disabled"),$("#bouquet_select option").removeAttr("disabled")),$("#timerbegin").prop("readonly",n),$("#timername").prop("readonly",n),void 0!==timer.vpsplugin_enabled?($("#vpsplugin_enabled").prop("checked",timer.vpsplugin_enabled),$("#vpsplugin_safemode").prop("checked",!timer.vpsplugin_overwrite),$("#has_vpsplugin1").show(),checkVPS()):$("#has_vpsplugin1").hide(),void 0!==timer.always_zap?($("#always_zap").prop("checked",1==timer.always_zap),$("#justplay").prop("disabled",1==timer.always_zap)):$("#always_zap").prop("disabled",!0),void 0!==timer.pipzap?($("#pipzap").prop("disabled",!1),$("#pipzap").prop("checked",1==timer.pipzap)):$("#pipzap").prop("disabled",!0),void 0!==timer.allow_duplicate&&$("#allow_duplicate").prop("checked",1==timer.allow_duplicate),openTimerDlg(tstr_edit_timer+" - "+timer.name);break}}})}var n=isRadio(current_serviceref=t);$("#cbtv").prop("checked",!n),$("#cbradio").prop("checked",n);!timeredit_initialized||n!=isRadio($("#bouquet_select option:last").val())?initTimerEdit(n,e):e()}function unEscape(e){return e=(e=(e=(e=(e=e.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&quot;/g,'"')).replace(/&#39;/g,"'")).replace(/&amp;/g,"&")}function addTimer(e,t,n,i,a){servicename=current_serviceref="";let o=current_end=current_begin=-1,r=-1,s="",c="",d="",l=0,u=0,p=void 0!==a;void 0!==e&&""!=e&&(o=e.begin,r=e.begin+e.duration,s=e.sref,servicename=e.channel,c=unEscape(e.title),d=unEscape(e.shortdesc),l=e.recording_margin_before,u=e.recording_margin_after,p=isRadio(s));function m(){void 0!==t&&void 0!==n&&(s=t,c=n,"undefined"===$("#bouquet_select").val(t)&&$("#bouquet_select").append($("<option></option>").attr("value",s).text(n))),$("#timername").val(c),$("#description").val(d),$("#dirname").val("None"),$("#enabled").prop("checked",!0),$("#justplay").prop("checked",!1),$("#allow_duplicate").prop("checked",!0),$("#afterevent").val(3),$("#recordingtype").val(""),$("#errorbox").hide();for(let e=0;e<7;e++)$("#day"+e).prop("checked",!1).checkboxradio("refresh");$("#tagsnew > input").prop("checked",!1).checkboxradio("refresh");var e=-1!==o?new Date(1e3*(Math.round(o)-60*l)):new Date,e=($("#timerbegin").datetimepicker("setDate",e),-1!==r?new Date(1e3*(Math.round(r)+60*u)):new Date(e.getTime()+36e5));$("#timerend").datetimepicker("setDate",e),$("#bouquet_select").val(s),$("#bouquet_select").trigger("chosen:updated"),openTimerDlg(tstr_add_timer)}a=$("#bouquet_select > optgroup").length;void 0!==t&&(p=isRadio(t)),$("#cbtv").prop("checked",!p),$("#cbradio").prop("checked",p);!timeredit_initialized||a<2||(e=$("#bouquet_select option:last").val(),p!=isRadio(e))?initTimerEdit(p,m):m()}function openTimerDlg(e){$("#editTimerForm").dialog("open"),$("#editTimerForm").dialog("option","title",e)}function InitAccordeon(e){$(e).accordion({active:!0,animate:!1,activate:function(e,t){t.oldPanel.empty(),t.oldPanel.html(tstr_loading+" ..."),t.newPanel.load(t.newHeader.find("a").attr("id"))},heightStyle:"content",collapsible:!0})}function RefreshMEPG(e){let t=$("#compressmepg").is(":visible"),n="";var i=GetLSValue("lastmbq_"+e,"");""!=i&&(n="&bref="+i),$("#tvcontent").html(loadspinner).load("ajax/multiepg?epgmode="+e+n,function(){t&&ExpandMEPG()})}function ExpandMEPG(){$("#expandmepg").hide(),$("#compressmepg").show(),$("#refreshmepg2").show(),$("#header").hide(),$("#leftmenu").hide(),$("#content").css("margin-left","5px"),$("#tvcontentmain > #toolbar-header").hide(),$("#tbl1body").height("100%"),$("#tvcontent").css("height","100%"),$("#tvcontentmain").css("height","950px"),fixTableHeight()}function CompressMEPG(){$("#refreshmepg").show(),$("#expandmepg").show(),$("#compressmepg").hide(),$("#refreshmepg").show(),$("#refreshmepg2").hide(),$("#header").show(),$("#leftmenu").show(),$("#content").css("margin-left","185px"),$("#tvcontentmain > #toolbar-header").show(),$("#tvcontent").css("height","730px"),$("#tvcontentmain").css("height","800px"),fixTableHeight()}function mainresize(){if(console.log("WH"+$(window).height()+"TVH"+$("#tvcontentmain").height()),$("#tvcontentmain"))try{fixTableHeight()}catch(e){}}var MLHelper,mepgdirect=0;function InitTVRadio(n){let e="radio"==n?"?stype=radio":"";$("#btn0").click(function(){$("#expandmepg").hide(),$("#refreshmepg").hide(),$("#tvcontent").html(loadspinner).load("ajax/current"+e)}),$("#btn5").click(function(){let e="";var t=GetLSValue("lastmbq_"+n,"");""!=t&&(e="&bref="+t),$("#tvcontent").html(loadspinner).load("ajax/multiepg?epgmode="+n+e),$("#expandmepg").show(),$("#refreshmepg").show()}),$("#btn1").click(function(){$("#expandmepg").hide(),$("#refreshmepg").hide(),$("#tvcontent").html(loadspinner).load("ajax/bouquets"+e)}),$("#btn2").click(function(){$("#expandmepg").hide(),$("#refreshmepg").hide(),$("#tvcontent").html(loadspinner).load("ajax/providers"+e)}),$("#btn3").click(function(){$("#expandmepg").hide(),$("#refreshmepg").hide(),$("#tvcontent").load("ajax/satellites"+e)}),$("#btn4").click(function(){$("#expandmepg").hide(),$("#refreshmepg").hide(),$("#tvcontent").html(loadspinner).load("ajax/channels"+e)}),$("#tvbutton").buttonset();e;if(!0===tv){var t=window.location.href.toLowerCase().split("#");if("tv"==t[1]){if("mepg"==t[2]||"mepgfull"==t[2])return mepgdirect=0,"mepgfull"==t[2]&&(mepgdirect=1),void $("#btn5").click();if("current"==t[2])return void $("#btn0").click()}}$("#tvcontent").load("ajax/bouquets"+e),"pepper-grinder"==theme&&$("#tvcontent").addClass("ui-state-active")}function InitBouquets(i){let e="";!0===i?$("#btn0").click(function(){$("#expandmepg").hide(),$("#refreshmepg").hide(),$("#tvcontent").html(loadspinner).load("ajax/current")}):(e="?stype=radio",$("#btn0").click(function(){$("#expandmepg").hide(),$("#refreshmepg").hide(),$("#tvcontent").html(loadspinner).load("ajax/current"+e)})),$("#btn5").click(function(){var e=!0===i?"tv":"radio";let t="";var n=GetLSValue("lastmbq_"+e,"");""!=n&&(t="&bref="+n),$("#tvcontent").html(loadspinner).load("ajax/multiepg?epgmode="+e+t),$("#expandmepg").show(),$("#refreshmepg").show()}),$("#btn1").click(function(){$("#expandmepg").hide(),$("#refreshmepg").hide(),$("#tvcontent").html(loadspinner).load("ajax/bouquets"+e)}),$("#btn2").click(function(){$("#expandmepg").hide(),$("#refreshmepg").hide(),$("#tvcontent").html(loadspinner).load("ajax/providers"+e)}),$("#btn3").click(function(){$("#expandmepg").hide(),$("#refreshmepg").hide(),$("#tvcontent").load("ajax/satellites"+e)}),$("#btn4").click(function(){$("#expandmepg").hide(),$("#refreshmepg").hide(),$("#tvcontent").html(loadspinner).load("ajax/channels"+e)}),$("#tvbutton").buttonset();e;if(!0===i){var t=window.location.href.toLowerCase().split("#");if("tv"==t[1]){if("mepg"==t[2]||"mepgfull"==t[2])return mepgdirect=0,"mepgfull"==t[2]&&(mepgdirect=1),void $("#btn5").click();if("current"==t[2])return void $("#btn0").click()}}$("#tvcontent").load("ajax/bouquets"+e),"pepper-grinder"==theme&&$("#tvcontent").addClass("ui-state-active")}function getWinSize(e){var t={};return void 0!==(e=e||window).innerWidth?(t.screenWidth=e.screen.width,t.screenHeight=e.screen.height):(t.screenWidth=0,t.screenHeight=0),t}function getDeviceType(){var e=getWinSize();return(e.screenHeight>e.screenWdith?e.screenHeight:e.screenWidth)<500?"phone":"tab"}function getOSType(){var e=navigator.userAgent;return-1<e.indexOf("iPod")||-1<e.indexOf("iPhone")||-1<e.indexOf("iPad")||-1<e.indexOf("ipod")||-1<e.indexOf("iphone")||-1<e.indexOf("ipad")?"ios":-1<e.indexOf("Android")||-1<e.indexOf("android")?"android":-1<e.indexOf("BlackBerry")||-1<e.indexOf("blackberry")?"blackberry":"unknown"}function jumper80(e){getDeviceType();document.portFormTs.file.value=e,document.portFormTs.device.value="etc",document.portFormTs.submit()}function jumper8003(e){getDeviceType();document.portFormTs.file.value=e,document.portFormTs.device.value="phone",document.portFormTs.submit()}function jumper8002(e,t){getDeviceType();document.portForm.ref.value=e,document.portForm.name.value=t,document.portForm.fname.value=t,document.portForm.device.value="phone",document.portForm.submit()}function jumper8001(e,t){getDeviceType();document.portForm.ref.value=e,document.portForm.name.value=t,document.portForm.fname.value=t,document.portForm.device.value="etc",document.portForm.submit()}function ChangeTheme(e){$.ajax({url:"api/settheme?theme="+e,success:function(){window.location.hash="#settings",window.location.reload(!0)}})}function directlink(){var e=window.location.hash.match(/^#((.*?[^\?]*)(\?.*)*)/)||[null,"",""],t=e[2],n=e[1];let i="ajax/tv";switch(t){case"radio":case"movies":case"timer":case"settings":case"at":case"bqe":case"epgr":case"myepg":case"epgdialog":case"timers":case"satfinder":case"boxinfo":case"webtv":case"about":case"screenshot":case"current":i="ajax/"+n}load_maincontent(i)}function ShowTimers(n){0<n.length&&$(".ETV tbody").each(function(e){var t=$(this).data("id").split(";");if(3==t.length){let o=t[0],r=parseInt(t[1]),s=r+60*parseInt(t[2]),c=$(this);n.forEach(function(e){var t,n,i,a;e.sref!=o&&0!==o.indexOf(e.sref)||(t=parseInt(e.begin),e=parseInt(e.end),s>t&&r<e&&(n=c.find(".addtimer").first(),i=c.find(".deltimer").first(),a=c.find(".timerpanel").first(),r>=t&&s<=e?(n.hide(),i.show(),a.css("background-color","red")):a.css("background-color","yellow")))})}})}function reversetheme(){return"pepper-grinder"==theme||"vader"==theme||"smoothness"==theme||"le-frog"==theme||"mint-choc"==theme||"humanity"==theme||"eggplant"==theme||"dot-luv"==theme||"black-tie"==theme}function getHoverCls(){return reversetheme()?"ui-state-active":"ui-state-hover"}function getActiveCls(){return reversetheme()?"ui-state-hover":"ui-state-active"}function setHover(e){let t=getHoverCls();$(e).hover(function(){$(this).addClass(t)},function(){$(this).removeClass(t)})}function setTMHover(){let e="ui-state-active";"pepper-grinder"==theme&&($(".tm_row").removeClass("ui-state-default"),$(".tm_row").addClass("ui-state-hover")),$(".tm_row").hover(function(){$(this).addClass(e)},function(){$(this).removeClass(e)})}function SetLSValue(e,t){"undefined"!=typeof Storage&&localStorage.setItem(e,t)}function GetLSValue(e,t){let n=t;if("undefined"!=typeof Storage){t=localStorage.getItem(e);if(null!=t){if("true"===t)return!0;if("false"===t)return!1;n=t}}return n}function SetSpinner(){var e=GetLSValue("spinner","fa-spinner");loadspinner="<div id='spinner'><div class='fa "+e+" fa-spin'></div></div>"}function isInArray(e,t){return 0<=e.indexOf(t)}function FillAllServices(e,o,t){let r="",s="",c=[];$.each(e,function(e,t){var n=t.servicereference,i=t.servicename,n=(s+="<option value='"+encodeURIComponent(n)+"'>"+i+"</option>",t.subservices);let a=[];$.each(n,function(e,t){let n=t.servicereference;var i,t=t.servicename;isInArray(c,n)||(c.push(n),"1:0:"==n.substring(0,4)&&(o&&0<(i=n.lastIndexOf("::"))&&(n=n.substring(0,i-1)),a.push("<option value='"+n+"'>"+t+"</option>")),"4097:"==n.substring(0,5)&&a.push("<option value='"+n+"'>"+t+"</option>"),"1:134:1"==n.substring(0,7)&&a.push("<option value='"+encodeURIComponent(n)+"'>"+t+"</option>"))}),0<a.length&&(r+="<optgroup label='"+i+"'>"+a.join("")+"</optgroup>")}),t(r,s)}function GetAllServices(o,t){if(void 0!==o){let n="gas-date",i="gas-data",e="",a=((t=void 0===t?!1:t)&&(n+="r",i+="r",e="&type=radio"),new Date);a=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate();t=GetLSValue(i,"");if(t===a)if(null!=(t=GetLSValue(n,null)))return void FillAllServices(JSON.parse(t).services,!1,o);$.ajax({url:"/api/getallservices?renameserviceforxmbc=1&exclude=lastscanned,vod,program"+e,dataType:"json",success:function(e){var t=JSON.stringify(e);SetLSValue(n,t),SetLSValue(i,a),FillAllServices(e.services,!1,o)}})}}function testPipStatus(){$.ajax({url:"api/pipinfo",dataType:"json",cache:!1,success:function(e){e.pip!=pipstatus&&(pipstatus=e.pip,buttonsSwitcher(e.pip))}})}void 0===MLHelper&&(MLHelper=new function(){var i;return{Init:function(){i=this},Load:function(e){$.widget("custom.iconselectmenu",$.ui.selectmenu,{_renderItem:function(e,t){var n=$("<li>"),t=$("<div>",{text:t.label}).prepend($("<span class='sortimg'>").append($("<i>",{class:"fa "+t.element.data("class")})));return n.append(t).appendTo(e)}}),$("#moviesort").iconselectmenu({change:function(e,t){MLHelper.SortMovies(t.item.value),MLHelper.ChangeSort(t.item.value)}}).addClass("ui-menu-icons"),i.SetSortImg(),i.ReadMovies()},SetSortImg:function(){$("#moviesort option").each(function(){var e;$(this).val()==$("#moviesort").val()&&(e=$(this).data("class"))&&(e=$("<span class='sortimg'>").append($("<i>",{class:"fa "+e})),$("#moviesort-button .ui-selectmenu-text").prepend(e))})},SortMovies:function(e){var n=i._movies.slice(0);"name"==e&&n.sort(function(e,t){e=e.title.toLowerCase(),t=t.title.toLowerCase();return e<t?-1:t<e?1:0}),"named"==e&&n.sort(function(e,t){t=t.title.toLowerCase(),e=e.title.toLowerCase();return t<e?-1:e<t?1:0}),"date"==e&&n.sort(function(e,t){return e.start-t.start}),"dated"==e&&n.sort(function(e,t){return t.start-e.start}),$("#movies").empty();for(let e=0,t=n.length;e<t;e++)$("#movies").append(n[e].html);return i.SetSortImg(),n},ChangeSort:function(e){$.ajax({url:"api/setmoviesort?nsort="+e,success:function(){}})},ReadMovies:function(){i._movies=[],$("#movies").children(".tm_row").each(function(){var e=$(this).data("start"),t=$(this).data("title");i._movies.push({id:$(this).attr("id"),title:t,start:e,html:$(this)})})},SetMovies:function(e){i._movies=e.slice()}}}).Init();var SSHelperObj=function(){var t;return{setup:function(){t=this,clearInterval(t.screenshotInterval),t.ssr_i=parseInt($("#ssr_i").val()),t.ssr_hd=$("#ssr_hd").is(":checked"),$("#screenshotbutton0").click(function(){testPipStatus(),grabScreenshot("all")}),$("#screenshotbutton1").click(function(){testPipStatus(),grabScreenshot("video")}),$("#screenshotbutton2").click(function(){testPipStatus(),grabScreenshot("osd")}),$("#screenshotbutton3").click(function(){testPipStatus(),grabScreenshot("pip")}),$("#screenshotbutton4").click(function(){testPipStatus(),grabScreenshot("lcd")}),$("#screenshotrefreshbutton").click(function(){testPipStatus()}),$("#screenshotbutton").buttonset(),$("#screenshotrefreshbutton").buttonset(),$("#ssr_i").val(t.ssr_i),$("#screenshotspinner").addClass(GetLSValue("spinner","fa-spinner")),$("#ssr_hd").change(function(){testPipStatus(),t.ssr_hd=$("#ssr_hd").is(":checked"),webapi_execute("/api/setwebconfig?screenshot_high_resolution="+(t.ssr_hd?"true":"false")),grabScreenshot("auto")}),$("#ssr_i").change(function(){testPipStatus();var e=$("#ssr_i").val();webapi_execute("/api/setwebconfig?screenshot_refresh_time="+e),t.ssr_i=parseInt(e),$("#ssr_s").is(":checked")&&(clearInterval(t.screenshotInterval),t.setSInterval())}),$("#ssr_s").change(function(){testPipStatus();var e=$("#ssr_s").is(":checked");e?t.setSInterval():clearInterval(t.screenshotInterval),webapi_execute("/api/setwebconfig?screenshot_refresh_auto="+(e?"true":"false"))}),grabScreenshot(screenshotMode="all"),$("#ssr_s").is(":checked")&&t.setSInterval()},setSInterval:function(){t.screenshotInterval=setInterval(function(){testPipStatus(),grabScreenshot("auto")},1e3*(t.ssr_i+1))}}},SSHelper=new SSHelperObj;function editmovie(e,t,n){var i="ajax/editmovie?sRef="+e;let a=tstr_edit_recording,o={};o[tstr_rename_recording]=function(){renameMovie(e,t)},o[tstr_save]=function(){editmovieAction(e,n)},o[tstr_cancel]=function(){$(this).dialog("close")},$.ajax({url:i,success:function(e){$("#modaldialog").html(e).dialog({modal:!0,title:a,autoOpen:!0,width:"auto",buttons:o,close:function(e,t){$(this).dialog("destroy"),$("#modaldialog").html("")}})}})}function editmovieAction(e,t){var n=$("#movieTitle").val();null==n||""==n?$("#modaldialog").dialog("close"):(e={sRef:decodeURI(e),desc:$("#movieDescription").val(),title:n},$.ajax({url:"/api/movieinfo",dataType:"json",cache:!1,data:e,success:function(e){e.result?($("#modaldialog").dialog("close"),load_maincontent_spin("ajax/movies?dirname="+t)):$("#movieResponse").html(e.resulttext)}}))}